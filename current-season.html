<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2025 Fall Season - Mountainside Aces</title>
<link rel="stylesheet" href="style.css">
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
  }

  .header {
    background: linear-gradient(135deg, #ff7b7b 0%, #ff6b6b 100%);
    color: white;
    text-align: center;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .header h1 {
    margin: 0;
    font-size: 2.5rem;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  }

  .header p {
    margin: 0.5rem 0 0 0;
    font-size: 1.1rem;
    opacity: 0.9;
  }

  .back-nav {
    background: rgba(255, 255, 255, 0.95);
    padding: 1rem 2rem;
    border-bottom: 1px solid #eee;
  }

  .back-nav a {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
    margin-right: 2rem;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    transition: background-color 0.3s;
  }

  .back-nav a:hover {
    background: #f8f9fa;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .section {
    background: white;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    overflow: hidden;
  }

  .section-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1.5rem 2rem;
    font-size: 1.4rem;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }

  .section-content {
    padding: 2rem;
  }

  .standings-table, .schedule-table, .bracket-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }

  .standings-table th, .schedule-table th, .bracket-table th,
  .standings-table td, .schedule-table td, .bracket-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #eee;
  }

  .standings-table th, .schedule-table th, .bracket-table th {
    background-color: #f8f9fa;
    font-weight: bold;
    color: #333;
  }

  .standings-table tr:nth-child(even), 
  .schedule-table tr:nth-child(even), 
  .bracket-table tr:nth-child(even) {
    background-color: #fafafa;
  }

  .standings-table tr:hover, 
  .schedule-table tr:hover, 
  .bracket-table tr:hover {
    background-color: #f0f0f0;
  }

  .team-name {
    font-weight: bold;
    color: #333;
  }

  .win-pct {
    font-weight: bold;
    color: #28a745;
  }

  .game-date {
    white-space: nowrap;
    font-weight: 500;
  }

  .game-score {
    text-align: center;
    font-weight: bold;
    color: #495057;
  }

  .winner {
    font-weight: bold;
    color: #007bff;
  }

  .upcoming {
    background-color: #fff3cd !important;
  }

  .playoff-game {
    background-color: #d1ecf1 !important;
  }

  .bracket-section {
    margin-bottom: 2rem;
  }

  .bracket-title {
    font-size: 1.2rem;
    font-weight: bold;
    color: #333;
    margin-bottom: 1rem;
    padding: 0.8rem 1rem;
    background: #f8f9fa;
    border-left: 4px solid #ff6b6b;
    border-radius: 4px;
  }

  .bracket-visual {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
  }

  .bracket-round {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1rem;
  }

  .bracket-round h4 {
    margin: 0 0 0.8rem 0;
    color: #333;
    font-size: 1rem;
  }

  .matchup {
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    padding: 0.8rem;
    margin-bottom: 0.8rem;
  }

  .matchup:last-child {
    margin-bottom: 0;
  }

  .team-in-bracket {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.3rem 0;
    border-bottom: 1px solid #eee;
  }

  .team-in-bracket:last-child {
    border-bottom: none;
  }

  .team-in-bracket.winner {
    font-weight: bold;
    color: #28a745;
  }

  .loading {
    text-align: center;
    padding: 2rem;
    color: #666;
    font-style: italic;
  }

  .no-data {
    text-align: center;
    padding: 2rem;
    color: #666;
  }

  .stats-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .stat-card {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    border-left: 4px solid #ff6b6b;
  }

  .stat-number {
    font-size: 1.8rem;
    font-weight: bold;
    color: #333;
  }

  .stat-label {
    font-size: 0.9rem;
    color: #666;
    margin-top: 0.2rem;
  }

  @media (max-width: 768px) {
    .container {
      padding: 1rem;
    }

    .section-content {
      padding: 1rem;
    }

    .standings-table, .schedule-table, .bracket-table {
      font-size: 0.9rem;
    }

    .standings-table th, .schedule-table th, .bracket-table th,
    .standings-table td, .schedule-table td, .bracket-table td {
      padding: 8px 6px;
    }

    .bracket-visual {
      grid-template-columns: 1fr;
    }

    .header h1 {
      font-size: 2rem;
    }
  }
</style>
</head>
<body>
  <div class="back-nav">
    <a href="index.html">‚Üê Home</a>
    <a href="batting.html">Batting Stats</a>
    <a href="pitching.html">Pitching Stats</a>
    <a href="teams.html">Teams</a>
    <a href="seasons.html">All Seasons</a>
  </div>

  <header class="header">
    <h1>üçÇ 2025 Fall Season</h1>
    <p>Current standings, schedule, results & playoff bracket</p>
  </header>

  <div class="container">
    <!-- Season Summary Stats -->
    <div class="section">
      <div class="section-header">
        üìä Season Overview
      </div>
      <div class="section-content">
        <div class="stats-summary" id="seasonSummary">
          <div class="stat-card">
            <div class="stat-number" id="totalTeams">--</div>
            <div class="stat-label">Teams</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="gamesPlayed">--</div>
            <div class="stat-label">Games Played</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="regularSeasonGames">--</div>
            <div class="stat-label">Regular Season</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="playoffGames">--</div>
            <div class="stat-label">Playoff Games</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Current Standings -->
    <div class="section">
      <div class="section-header">
        üèÜ Current Standings
      </div>
      <div class="section-content">
        <div id="standingsContent" class="loading">Loading standings...</div>
      </div>
    </div>

    <!-- Upcoming Schedule -->
    <div class="section">
      <div class="section-header">
        üìÖ Upcoming Schedule
      </div>
      <div class="section-content">
        <div id="scheduleContent" class="loading">Loading schedule...</div>
      </div>
    </div>

    <!-- Past Game Results -->
    <div class="section">
      <div class="section-header">
        üìã Recent Game Results
      </div>
      <div class="section-content">
        <div id="resultsContent" class="loading">Loading results...</div>
      </div>
    </div>

    <!-- Projected Playoff Bracket -->
    <div class="section">
      <div class="section-header">
        üèüÔ∏è Playoff Bracket
      </div>
      <div class="section-content">
        <div id="bracketContent" class="loading">Loading playoff bracket...</div>
      </div>
    </div>
  </div>

  <script>
    let allGames = [];
    const currentSeason = "Fall";
    const currentYear = "2025";
    const today = new Date();

    // Load games data and initialize page
    async function loadData() {
      try {
        const response = await fetch('games.json');
        if (!response.ok) throw new Error('Failed to load games data');
        
        allGames = await response.json();
        
        // Filter for current season
        const seasonGames = allGames.filter(g => 
          g.year === currentYear && g.season === currentSeason
        );

        updateSeasonSummary(seasonGames);
        updateStandings(seasonGames);
        updateUpcomingSchedule(seasonGames);
        updateRecentResults(seasonGames);
        updatePlayoffBracket(seasonGames);

      } catch (error) {
        console.error('Error loading data:', error);
        showError();
      }
    }

    function parseGameDate(dateStr) {
      return new Date(dateStr);
    }

    function updateSeasonSummary(games) {
      const teams = new Set();
      const completedGames = games.filter(g => 
        parseGameDate(g.date) < today && g.winner && g.winner.trim() !== ""
      );
      const regularGames = completedGames.filter(g => g.game_type === 'Regular');
      const playoffGames = completedGames.filter(g => g.game_type === 'Playoff');

      games.forEach(g => {
        teams.add(g["home team"]);
        teams.add(g["away team"]);
      });

      document.getElementById('totalTeams').textContent = teams.size;
      document.getElementById('gamesPlayed').textContent = completedGames.length;
      document.getElementById('regularSeasonGames').textContent = regularGames.length;
      document.getElementById('playoffGames').textContent = playoffGames.length;
    }

    function updateStandings(games) {
      const completedGames = games.filter(g => 
        parseGameDate(g.date) < today && g.winner && g.winner.trim() !== ""
      );
      const regularGames = completedGames.filter(g => g.game_type === 'Regular');
      
      if (regularGames.length === 0) {
        document.getElementById('standingsContent').innerHTML = 
          '<div class="no-data">No completed games yet this season.</div>';
        return;
      }

      const standings = calculateStandings(regularGames);
      const html = generateStandingsTable('Regular Season Standings', standings);
      document.getElementById('standingsContent').innerHTML = html;
    }

    function calculateStandings(games) {
      const teamStats = {};

      games.forEach(game => {
        const homeTeam = game["home team"];
        const awayTeam = game["away team"];
        const winner = game.winner;
        const homeScore = parseInt(game["home score"]) || 0;
        const awayScore = parseInt(game["away score"]) || 0;

        if (!teamStats[homeTeam]) {
          teamStats[homeTeam] = { 
            name: homeTeam, wins: 0, losses: 0, ties: 0, 
            runsFor: 0, runsAgainst: 0, h2h: {}
          };
        }
        if (!teamStats[awayTeam]) {
          teamStats[awayTeam] = { 
            name: awayTeam, wins: 0, losses: 0, ties: 0, 
            runsFor: 0, runsAgainst: 0, h2h: {}
          };
        }

        // Add runs
        teamStats[homeTeam].runsFor += homeScore;
        teamStats[homeTeam].runsAgainst += awayScore;
        teamStats[awayTeam].runsFor += awayScore;
        teamStats[awayTeam].runsAgainst += homeScore;

        // Initialize H2H if needed
        if (!teamStats[homeTeam].h2h[awayTeam]) {
          teamStats[homeTeam].h2h[awayTeam] = { wins: 0, losses: 0, ties: 0 };
        }
        if (!teamStats[awayTeam].h2h[homeTeam]) {
          teamStats[awayTeam].h2h[homeTeam] = { wins: 0, losses: 0, ties: 0 };
        }

        // Record results
        if (winner === "Tie") {
          teamStats[homeTeam].ties++;
          teamStats[awayTeam].ties++;
          teamStats[homeTeam].h2h[awayTeam].ties++;
          teamStats[awayTeam].h2h[homeTeam].ties++;
        } else if (winner === homeTeam) {
          teamStats[homeTeam].wins++;
          teamStats[awayTeam].losses++;
          teamStats[homeTeam].h2h[awayTeam].wins++;
          teamStats[awayTeam].h2h[homeTeam].losses++;
        } else if (winner === awayTeam) {
          teamStats[awayTeam].wins++;
          teamStats[homeTeam].losses++;
          teamStats[awayTeam].h2h[homeTeam].wins++;
          teamStats[homeTeam].h2h[awayTeam].losses++;
        }
      });

      return Object.values(teamStats)
        .map(team => {
          const totalDecided = team.wins + team.losses;
          team.winPct = totalDecided > 0 ? (team.wins / totalDecided) : 0;
          team.runDifferential = team.runsFor - team.runsAgainst;
          return team;
        })
        .sort((a, b) => {
          if (a.winPct !== b.winPct) return b.winPct - a.winPct;
          
          const h2hComp = compareHeadToHead(a, b);
          if (h2hComp !== 0) return h2hComp;
          
          if (a.runsAgainst !== b.runsAgainst) return a.runsAgainst - b.runsAgainst;
          
          return b.runDifferential - a.runDifferential;
        });
    }

    function compareHeadToHead(teamA, teamB) {
      const aVsB = teamA.h2h[teamB.name];
      const bVsA = teamB.h2h[teamA.name];
      
      if (!aVsB || !bVsA) return 0;
      
      const aH2HWinPct = (aVsB.wins + aVsB.losses) > 0 ? aVsB.wins / (aVsB.wins + aVsB.losses) : 0;
      const bH2HWinPct = (bVsA.wins + bVsA.losses) > 0 ? bVsA.wins / (bVsA.wins + bVsA.losses) : 0;
      
      return bH2HWinPct - aH2HWinPct;
    }

    function generateStandingsTable(title, standings) {
      return `
        <div class="bracket-title">${title}</div>
        <table class="standings-table">
          <thead>
            <tr>
              <th>Rank</th><th>Team</th><th>Wins</th><th>Losses</th><th>Ties</th>
              <th>Win%</th><th>RF</th><th>RA</th><th>Diff</th><th>Games</th>
            </tr>
          </thead>
          <tbody>
            ${standings.map((team, index) => `
              <tr>
                <td>${index + 1}</td>
                <td class="team-name">${team.name}</td>
                <td>${team.wins}</td><td>${team.losses}</td><td>${team.ties}</td>
                <td class="win-pct">${(team.winPct * 100).toFixed(1)}%</td>
                <td>${team.runsFor}</td><td>${team.runsAgainst}</td>
                <td style="color: ${team.runDifferential >= 0 ? '#28a745' : '#dc3545'}">
                  ${team.runDifferential >= 0 ? '+' : ''}${team.runDifferential}
                </td>
                <td>${team.wins + team.losses + team.ties}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }

    function updateUpcomingSchedule(games) {
      const upcomingGames = games
        .filter(g => {
          const gameDate = parseGameDate(g.date);
          const isFuture = gameDate >= today;
          const noWinner = !g.winner || g.winner.trim() === "";
          return isFuture && noWinner;
        })
        .sort((a, b) => parseGameDate(a.date) - parseGameDate(b.date))
        .slice(0, 10);

      if (upcomingGames.length === 0) {
        document.getElementById('scheduleContent').innerHTML = `
          <div class="no-data">
            <h4>No Upcoming Games</h4>
            <p>No upcoming games scheduled at this time.</p>
          </div>
        `;
        return;
      }

      const html = `
        <table class="schedule-table">
          <thead>
            <tr><th>Date</th><th>Home Team</th><th>vs</th><th>Away Team</th><th>Type</th></tr>
          </thead>
          <tbody>
            ${upcomingGames.map(game => `
              <tr class="upcoming">
                <td class="game-date">${game.date}</td>
                <td class="team-name">${game["home team"]}</td>
                <td class="game-score">vs</td>
                <td class="team-name">${game["away team"]}</td>
                <td>${game.game_type}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;

      document.getElementById('scheduleContent').innerHTML = html;
    }

    function updateRecentResults(games) {
      const recentGames = games
        .filter(g => parseGameDate(g.date) < today && g.winner && g.winner.trim() !== "")
        .sort((a, b) => parseGameDate(b.date) - parseGameDate(a.date))
        .slice(0, 10);

      if (recentGames.length === 0) {
        document.getElementById('resultsContent').innerHTML = 
          '<div class="no-data">No completed games yet this season.</div>';
        return;
      }

      const html = `
        <table class="schedule-table">
          <thead>
            <tr><th>Date</th><th>Home Team</th><th>Score</th><th>Away Team</th><th>Winner</th><th>Type</th></tr>
          </thead>
          <tbody>
            ${recentGames.map(game => {
              const forfeit = game.forfeit === "Yes" ? " (Forfeit)" : "";
              let scoreDisplay = `${game["home score"]} - ${game["away score"]}`;
              
              if (game["home score"] === "W" && game["away score"] === "L") {
                scoreDisplay = "W - L";
              } else if (game["home score"] === "L" && game["away score"] === "W") {
                scoreDisplay = "L - W";
              }

              return `
                <tr class="${game.game_type === 'Playoff' ? 'playoff-game' : ''}">
                  <td class="game-date">${game.date}</td>
                  <td class="team-name">${game["home team"]}</td>
                  <td class="game-score">${scoreDisplay}${forfeit}</td>
                  <td class="team-name">${game["away team"]}</td>
                  <td class="winner">${game.winner}</td>
                  <td>${game.game_type}</td>
                </tr>
              `;
            }).join('')}
          </tbody>
        </table>
      `;

      document.getElementById('resultsContent').innerHTML = html;
    }

    function updatePlayoffBracket(games) {
      const completedGames = games.filter(g => 
        g.winner && g.winner.trim() !== "" && parseGameDate(g.date) < today
      );
      
      const regularGames = completedGames.filter(g => g.game_type === 'Regular');
      const standings = calculateStandings(regularGames);
      
      if (standings.length < 10) {
        document.getElementById('bracketContent').innerHTML = `
          <div class="no-data">
            <h4>Projected Playoff Bracket</h4>
            <p>Need at least 10 teams to generate playoff bracket. Currently have ${standings.length} teams.</p>
          </div>
        `;
        return;
      }

      const playoffTeams = standings.slice(0, 10);
      
      const html = `
        <div class="bracket-title">Projected Double Elimination Playoff Bracket</div>
        <div class="bracket-section">
          <h4>Playoff Seeding (Top 10 Teams)</h4>
          <table class="bracket-table">
            <thead>
              <tr><th>Seed</th><th>Team</th><th>Record</th><th>Win%</th><th>Run Diff</th></tr>
            </thead>
            <tbody>
              ${playoffTeams.map((team, index) => `
                <tr>
                  <td><strong>${index + 1}</strong></td>
                  <td class="team-name">${team.name}</td>
                  <td>${team.wins}-${team.losses}${team.ties > 0 ? `-${team.ties}` : ''}</td>
                  <td class="win-pct">${(team.winPct * 100).toFixed(1)}%</td>
                  <td style="color: ${team.runDifferential >= 0 ? '#28a745' : '#dc3545'}">
                    ${team.runDifferential >= 0 ? '+' : ''}${team.runDifferential}
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>

        <div class="bracket-section">
          <h4>First Round Playoff Matchups</h4>
          <div class="bracket-visual">
            <div class="bracket-round">
              <h4>Play-in Game 1</h4>
              <div class="matchup">
                <div class="team-in-bracket">
                  <span><strong>#7</strong> ${playoffTeams[6].name}</span>
                  <span>${playoffTeams[6].wins}-${playoffTeams[6].losses}</span>
                </div>
                <div class="team-in-bracket">
                  <span><strong>#10</strong> ${playoffTeams[9].name}</span>
                  <span>${playoffTeams[9].wins}-${playoffTeams[9].losses}</span>
                </div>
                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                  Winner plays #2 seed
                </div>
              </div>
            </div>

            <div class="bracket-round">
              <h4>Play-in Game 2</h4>
              <div class="matchup">
                <div class="team-in-bracket">
                  <span><strong>#8</strong> ${playoffTeams[7].name}</span>
                  <span>${playoffTeams[7].wins}-${playoffTeams[7].losses}</span>
                </div>
                <div class="team-in-bracket">
                  <span><strong>#9</strong> ${playoffTeams[8].name}</span>
                  <span>${playoffTeams[8].wins}-${playoffTeams[8].losses}</span>
                </div>
                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                  Winner plays #1 seed
                </div>
              </div>
            </div>
          </div>

          <h4>First Round Byes</h4>
          <div class="bracket-visual">
            <div class="bracket-round">
              <h4>Top Seeds</h4>
              <div class="matchup">
                <div class="team-in-bracket">
                  <span><strong>#1</strong> ${playoffTeams[0].name}</span>
                  <span>BYE</span>
                </div>
                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                  vs Winner of 8v9
                </div>
              </div>
              
              <div class="matchup">
                <div class="team-in-bracket">
                  <span><strong>#2</strong> ${playoffTeams[1].name}</span>
                  <span>BYE</span>
                </div>
                <div style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                  vs Winner of 7v10
                </div>
              </div>
            </div>

            <div class="bracket-round">
              <h4>Middle Seeds</h4>
              ${[3, 4, 5, 6].map(seed => {
                const team = playoffTeams[seed - 1];
                return `
                  <div class="matchup">
                    <div class="team-in-bracket">
                      <span><strong>#${seed}</strong> ${team.name}</span>
                      <span>${team.wins}-${team.losses}</span>
                    </div>
                    <div style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                      Awaits bracket setup
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        </div>

        <div class="bracket-section">
          <div class="no-data">
            <p><em>Double elimination format: Teams are eliminated after losing 2 games. 
            Play-in games determine final bracket positioning.</em></p>
          </div>
        </div>
      `;

      document.getElementById('bracketContent').innerHTML = html;
    }

    function showError() {
      const errorHtml = '<div class="no-data">Error loading season data. Please try again later.</div>';
      document.getElementById('standingsContent').innerHTML = errorHtml;
      document.getElementById('scheduleContent').innerHTML = errorHtml;
      document.getElementById('resultsContent').innerHTML = errorHtml;
      document.getElementById('bracketContent').innerHTML = errorHtml;
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', loadData);
  </script>
</body>
</html>