<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2025 Fall Season - Mountainside Aces</title>
<link rel="stylesheet" href="style.css">
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
  }

  .header {
    background: linear-gradient(135deg, #ff7b7b 0%, #ff6b6b 100%);
    color: white;
    text-align: center;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .header h1 {
    margin: 0;
    font-size: 2.5rem;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  }

  .header p {
    margin: 0.5rem 0 0 0;
    font-size: 1.1rem;
    opacity: 0.9;
  }

  .back-nav {
    background: rgba(255, 255, 255, 0.95);
    padding: 1rem 2rem;
    border-bottom: 1px solid #eee;
  }

  .back-nav a {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
    margin-right: 2rem;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    transition: background-color 0.3s;
  }

  .back-nav a:hover {
    background: #f8f9fa;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .section {
    background: white;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    overflow: hidden;
  }

  .section-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1.5rem 2rem;
    font-size: 1.4rem;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }

  .section-content {
    padding: 2rem;
  }

  .standings-table, .schedule-table, .bracket-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }

  .standings-table th, .schedule-table th, .bracket-table th,
  .standings-table td, .schedule-table td, .bracket-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #eee;
  }

  .standings-table th, .schedule-table th, .bracket-table th {
    background-color: #f8f9fa;
    font-weight: bold;
    color: #333;
  }

  .standings-table tr:nth-child(even), 
  .schedule-table tr:nth-child(even), 
  .bracket-table tr:nth-child(even) {
    background-color: #fafafa;
  }

  .standings-table tr:hover, 
  .schedule-table tr:hover, 
  .bracket-table tr:hover {
    background-color: #f0f0f0;
  }

  .team-name {
    font-weight: bold;
    color: #333;
  }

  .win-pct {
    font-weight: bold;
    color: #28a745;
  }

  .game-date {
    white-space: nowrap;
    font-weight: 500;
  }

  .game-score {
    text-align: center;
    font-weight: bold;
    color: #495057;
  }

  .winner {
    font-weight: bold;
    color: #007bff;
  }

  .upcoming {
    background-color: #fff3cd !important;
  }

  .playoff-game {
    background-color: #d1ecf1 !important;
  }

  .bracket-section {
    margin-bottom: 2rem;
  }

  .bracket-title {
    font-size: 1.2rem;
    font-weight: bold;
    color: #333;
    margin-bottom: 1rem;
    padding: 0.8rem 1rem;
    background: #f8f9fa;
    border-left: 4px solid #ff6b6b;
    border-radius: 4px;
  }

  .bracket-visual {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
  }

  .bracket-round {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1rem;
  }

  .bracket-round h4 {
    margin: 0 0 0.8rem 0;
    color: #333;
    font-size: 1rem;
  }

  .matchup {
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    padding: 0.8rem;
    margin-bottom: 0.8rem;
  }

  .matchup:last-child {
    margin-bottom: 0;
  }

  .team-in-bracket {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.3rem 0;
    border-bottom: 1px solid #eee;
  }

  .team-in-bracket:last-child {
    border-bottom: none;
  }

  .team-in-bracket.winner {
    font-weight: bold;
    color: #28a745;
  }

  .loading {
    text-align: center;
    padding: 2rem;
    color: #666;
    font-style: italic;
  }

  .no-data {
    text-align: center;
    padding: 2rem;
    color: #666;
  }

  .stats-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .stat-card {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    border-left: 4px solid #ff6b6b;
  }

  .stat-number {
    font-size: 1.8rem;
    font-weight: bold;
    color: #333;
  }

  .stat-label {
    font-size: 0.9rem;
    color: #666;
    margin-top: 0.2rem;
  }

  @media (max-width: 768px) {
    .container {
      padding: 1rem;
    }

    .section-content {
      padding: 1rem;
    }

    .standings-table, .schedule-table, .bracket-table {
      font-size: 0.9rem;
    }

    .standings-table th, .schedule-table th, .bracket-table th,
    .standings-table td, .schedule-table td, .bracket-table td {
      padding: 8px 6px;
    }

    .bracket-visual {
      grid-template-columns: 1fr;
    }

    .header h1 {
      font-size: 2rem;
    }
  }
</style>
</head>
<body>
  <div class="back-nav">
    <a href="index.html">‚Üê Home</a>
    <a href="batting.html">Batting Stats</a>
    <a href="pitching.html">Pitching Stats</a>
    <a href="teams.html">Teams</a>
    <a href="seasons.html">All Seasons</a>
  </div>

  <header class="header">
    <h1>üçÇ 2025 Fall Season</h1>
    <p>Current standings, schedule, results & playoff bracket</p>
  </header>

  <div class="container">
    <!-- Season Summary Stats -->
    <div class="section">
      <div class="section-header">
        üìä Season Overview
      </div>
      <div class="section-content">
        <div class="stats-summary" id="seasonSummary">
          <div class="stat-card">
            <div class="stat-number" id="totalTeams">--</div>
            <div class="stat-label">Teams</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="gamesPlayed">--</div>
            <div class="stat-label">Games Played</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="regularSeasonGames">--</div>
            <div class="stat-label">Regular Season</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="playoffGames">--</div>
            <div class="stat-label">Playoff Games</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Current Standings -->
    <div class="section">
      <div class="section-header">
        üèÜ Current Standings
      </div>
      <div class="section-content">
        <div id="standingsContent" class="loading">Loading standings...</div>
      </div>
    </div>

    <!-- Upcoming Schedule -->
    <div class="section">
      <div class="section-header">
        üìÖ Upcoming Schedule
      </div>
      <div class="section-content">
        <div id="scheduleContent" class="loading">Loading schedule...</div>
      </div>
    </div>

    <!-- Past Game Results -->
    <div class="section">
      <div class="section-header">
        üìã Recent Game Results
      </div>
      <div class="section-content">
        <div id="resultsContent" class="loading">Loading results...</div>
      </div>
    </div>

    <!-- Projected Playoff Bracket -->
    <div class="section">
      <div class="section-header">
        üèüÔ∏è Playoff Bracket
      </div>
      <div class="section-content">
        <div id="bracketContent" class="loading">Loading playoff bracket...</div>
      </div>
    </div>
  </div>

  <script>
    let allGames = [];
    const currentSeason = "Fall";
    const currentYear = "2025";

    // Load games data and initialize page
    async function loadData() {
      try {
        const response = await fetch('games.json');
        if (!response.ok) throw new Error('Failed to load games data');
        
        allGames = await response.json();
        
        // Filter for current season
        const seasonGames = allGames.filter(g => 
          g.year === currentYear && g.season === currentSeason
        );

        updateSeasonSummary(seasonGames);
        updateStandings(seasonGames);
        updateUpcomingSchedule(seasonGames);
        updateRecentResults(seasonGames);
        updatePlayoffBracket(seasonGames);

      } catch (error) {
        console.error('Error loading data:', error);
        showError();
      }
    }

    function updateSeasonSummary(games) {
      const teams = new Set();
      const regularGames = games.filter(g => g.game_type === 'Regular');
      const playoffGames = games.filter(g => g.game_type === 'Playoff');

      games.forEach(g => {
        teams.add(g["home team"]);
        teams.add(g["away team"]);
      });

      document.getElementById('totalTeams').textContent = teams.size;
      document.getElementById('gamesPlayed').textContent = games.length;
      document.getElementById('regularSeasonGames').textContent = regularGames.length;
      document.getElementById('playoffGames').textContent = playoffGames.length;
    }

    function updateStandings(games) {
      const regularGames = games.filter(g => g.game_type === 'Regular');
      const playoffGames = games.filter(g => g.game_type === 'Playoff');
      
      let html = '';
      
      if (regularGames.length > 0) {
        const regularStandings = calculateStandings(regularGames);
        html += generateStandingsTable('Regular Season Standings', regularStandings);
      }

      if (playoffGames.length > 0) {
        const playoffStandings = calculateStandings(playoffGames);
        html += generateStandingsTable('Playoff Standings', playoffStandings);
      }

      if (!html) {
        html = '<div class="no-data">No games played yet this season.</div>';
      }

      document.getElementById('standingsContent').innerHTML = html;
    }

    function calculateStandings(games) {
      const teamStats = {};

      games.forEach(game => {
        const homeTeam = game["home team"];
        const awayTeam = game["away team"];
        const winner = game.winner;

        if (!teamStats[homeTeam]) {
          teamStats[homeTeam] = { name: homeTeam, wins: 0, losses: 0, ties: 0 };
        }
        if (!teamStats[awayTeam]) {
          teamStats[awayTeam] = { name: awayTeam, wins: 0, losses: 0, ties: 0 };
        }

        if (winner === "Tie") {
          teamStats[homeTeam].ties++;
          teamStats[awayTeam].ties++;
        } else if (winner === homeTeam) {
          teamStats[homeTeam].wins++;
          teamStats[awayTeam].losses++;
        } else if (winner === awayTeam) {
          teamStats[awayTeam].wins++;
          teamStats[homeTeam].losses++;
        }
      });

      return Object.values(teamStats)
        .map(team => {
          const totalDecided = team.wins + team.losses;
          team.winPct = totalDecided > 0 ? (team.wins / totalDecided) : 0;
          return team;
        })
        .sort((a, b) => b.winPct - a.winPct || b.wins - a.wins);
    }

    function generateStandingsTable(title, standings) {
      return `
        <div class="bracket-title">${title}</div>
        <table class="standings-table">
          <thead>
            <tr>
              <th>Rank</th>
              <th>Team</th>
              <th>Wins</th>
              <th>Losses</th>
              <th>Ties</th>
              <th>Win%</th>
              <th>Games</th>
            </tr>
          </thead>
          <tbody>
            ${standings.map((team, index) => `
              <tr>
                <td>${index + 1}</td>
                <td class="team-name">${team.name}</td>
                <td>${team.wins}</td>
                <td>${team.losses}</td>
                <td>${team.ties}</td>
                <td class="win-pct">${(team.winPct * 100).toFixed(1)}%</td>
                <td>${team.wins + team.losses + team.ties}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }

    function updateUpcomingSchedule(games) {
      // Since we don't have future games in the data, we'll show this as a placeholder
      // In a real system, this would show upcoming scheduled games
      const html = `
        <div class="no-data">
          <h4>Upcoming Games</h4>
          <p>No upcoming games scheduled at this time.</p>
          <p><em>Check back for playoff schedule updates as the regular season concludes.</em></p>
        </div>
      `;
      document.getElementById('scheduleContent').innerHTML = html;
    }

    function updateRecentResults(games) {
      // Get the most recent 10 games
      const recentGames = games
        .sort((a, b) => new Date(b.date) - new Date(a.date))
        .slice(0, 10);

      if (recentGames.length === 0) {
        document.getElementById('resultsContent').innerHTML = 
          '<div class="no-data">No games played yet this season.</div>';
        return;
      }

      const html = `
        <table class="schedule-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Home Team</th>
              <th>Score</th>
              <th>Away Team</th>
              <th>Winner</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody>
            ${recentGames.map(game => {
              const forfeit = game.forfeit === "Yes" ? " (Forfeit)" : "";
              let scoreDisplay;
              
              if (game["home score"] === "W" && game["away score"] === "L") {
                scoreDisplay = "W - L";
              } else if (game["home score"] === "L" && game["away score"] === "W") {
                scoreDisplay = "L - W";
              } else {
                scoreDisplay = `${game["home score"]} - ${game["away score"]}`;
              }

              return `
                <tr class="${game.game_type === 'Playoff' ? 'playoff-game' : ''}">
                  <td class="game-date">${game.date}</td>
                  <td class="team-name">${game["home team"]}</td>
                  <td class="game-score">${scoreDisplay}${forfeit}</td>
                  <td class="team-name">${game["away team"]}</td>
                  <td class="winner">${game.winner}</td>
                  <td>${game.game_type}</td>
                </tr>
              `;
            }).join('')}
          </tbody>
        </table>
      `;

      document.getElementById('resultsContent').innerHTML = html;
    }

    function updatePlayoffBracket(games) {
      const playoffGames = games.filter(g => g.game_type === 'Playoff');
      
      if (playoffGames.length === 0) {
        document.getElementById('bracketContent').innerHTML = `
          <div class="no-data">
            <h4>Playoff Bracket</h4>
            <p>Playoffs have not started yet.</p>
            <p><em>The bracket will be updated as teams qualify and playoff games begin.</em></p>
          </div>
        `;
        return;
      }

      // Generate double elimination bracket
      const bracketHtml = generateDoubleEliminationBracket(playoffGames);
      document.getElementById('bracketContent').innerHTML = bracketHtml;
    }

    function generateDoubleEliminationBracket(playoffGames) {
      // Get all teams that participated in playoffs
      const playoffTeams = new Set();
      playoffGames.forEach(game => {
        playoffTeams.add(game["home team"]);
        playoffTeams.add(game["away team"]);
      });

      // Calculate current playoff standings to determine bracket position
      const playoffStandings = calculateStandings(playoffGames);
      
      // Group games by date to show bracket progression
      const gamesByDate = {};
      playoffGames.forEach(game => {
        if (!gamesByDate[game.date]) {
          gamesByDate[game.date] = [];
        }
        gamesByDate[game.date].push(game);
      });

      const sortedDates = Object.keys(gamesByDate).sort((a, b) => new Date(a) - new Date(b));

      let html = `
        <div class="bracket-title">Double Elimination Tournament</div>
        <div class="bracket-section">
          <h4>Current Playoff Standings</h4>
          <table class="bracket-table">
            <thead>
              <tr>
                <th>Rank</th>
                <th>Team</th>
                <th>Wins</th>
                <th>Losses</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${playoffStandings.map((team, index) => {
                let status = 'Active';
                if (team.losses >= 2) status = 'Eliminated';
                else if (index === 0 && team.wins >= 2) status = 'Champion';
                
                return `
                  <tr>
                    <td>${index + 1}</td>
                    <td class="team-name">${team.name}</td>
                    <td>${team.wins}</td>
                    <td>${team.losses}</td>
                    <td class="${status.toLowerCase()}">${status}</td>
                  </tr>
                `;
              }).join('')}
            </tbody>
          </table>
        </div>

        <div class="bracket-section">
          <h4>Game Results by Date</h4>
      `;

      sortedDates.forEach(date => {
        const dateGames = gamesByDate[date];
        html += `
          <div class="bracket-title">${date}</div>
          <div class="bracket-visual">
        `;

        dateGames.forEach((game, index) => {
          const forfeit = game.forfeit === "Yes" ? " (Forfeit)" : "";
          let scoreDisplay;
          
          if (game["home score"] === "W" && game["away score"] === "L") {
            scoreDisplay = "W - L";
          } else if (game["home score"] === "L" && game["away score"] === "W") {
            scoreDisplay = "L - W";
          } else {
            scoreDisplay = `${game["home score"]} - ${game["away score"]}`;
          }

          html += `
            <div class="matchup">
              <div class="team-in-bracket ${game.winner === game["home team"] ? 'winner' : ''}">
                <span>${game["home team"]}</span>
                <span>${game["home score"]}</span>
              </div>
              <div class="team-in-bracket ${game.winner === game["away team"] ? 'winner' : ''}">
                <span>${game["away team"]}</span>
                <span>${game["away score"]}</span>
              </div>
              <div style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                Winner: <strong>${game.winner}</strong>${forfeit}
              </div>
            </div>
          `;
        });

        html += `
          </div>
        `;
      });

      html += `
        </div>
        <div class="bracket-section">
          <div class="no-data">
            <p><em>Double elimination format: Teams are eliminated after losing 2 games. 
            The winner's bracket champion needs to be beaten twice by the loser's bracket champion to lose the tournament.</em></p>
          </div>
        </div>
      `;

      return html;
    }

    function showError() {
      const errorHtml = '<div class="no-data">Error loading season data. Please try again later.</div>';
      document.getElementById('standingsContent').innerHTML = errorHtml;
      document.getElementById('scheduleContent').innerHTML = errorHtml;
      document.getElementById('resultsContent').innerHTML = errorHtml;
      document.getElementById('bracketContent').innerHTML = errorHtml;
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', loadData);
  </script>
</body>
</html>