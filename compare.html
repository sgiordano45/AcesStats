<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player Comparison - Aces Stats</title>
<link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="mobile-enhancements.css">
<style>
  .comparison-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 20px;
  }
  
  .player-selector {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
  }
  
  .player-selector h3 {
    margin: 0 0 15px 0;
    text-align: center;
    color: #333;
  }
  
  .player-select {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-bottom: 15px;
  }
  
  .comparison-type {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-bottom: 20px;
  }
  
  .comparison-type button {
    padding: 10px 20px;
    border: 1px solid #ccc;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }
  
  .comparison-type button.active {
    background-color: #0066cc;
    color: white;
    border-color: #0066cc;
  }
  
  .comparison-type button:not(.active) {
    background-color: #f0f0f0;
    color: black;
  }
  
  .comparison-results {
    margin-top: 30px;
  }
  
  .career-comparison {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 20px;
    margin-bottom: 30px;
  }
  
  .player-career-stats {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
  }
  
  .player-career-stats h4 {
    margin: 0 0 15px 0;
    text-align: center;
    font-size: 1.2em;
    color: #333;
  }
  
  .stat-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid #eee;
  }
  
  .stat-row:last-child {
    border-bottom: none;
  }
  
  .stat-label {
    font-weight: bold;
    color: #666;
  }
  
  .stat-value {
    font-weight: bold;
    color: #333;
  }
  
  .comparison-divider {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2em;
    color: #ccc;
    font-weight: bold;
  }
  
  .back-nav {
    margin-bottom: 20px;
  }
  
  .back-nav a {
    padding: 8px 15px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    text-decoration: none;
    border-radius: 3px;
    margin-right: 10px;
    color: #333;
  }
  
  .back-nav a:hover {
    background-color: #e0e0e0;
  }
  
  .pitching-link {
    background-color: #e6ffe6 !important;
    border-color: #00aa00 !important;
    color: #006600 !important;
  }
  
  .pitching-link:hover {
    background-color: #d4ffd4 !important;
  }
  
  .no-comparison {
    text-align: center;
    padding: 40px;
    color: #666;
    font-style: italic;
  }
  
  /* Mobile responsive adjustments */
  @media (max-width: 768px) {
    .comparison-container {
      grid-template-columns: 1fr;
    }
    
    .career-comparison {
      grid-template-columns: 1fr;
    }
    
    .comparison-divider {
      display: none;
    }
    
    .comparison-type {
      flex-direction: column;
      align-items: center;
    }
    
    .comparison-type button {
      width: 200px;
    }
    
    .back-nav {
      text-align: center;
    }
    
    .back-nav a {
      display: inline-block;
      margin: 2px;
      padding: 10px 12px;
      font-size: 14px;
    }
  }
  
  @media (max-width: 480px) {
    .back-nav a {
      display: block;
      margin: 5px 0;
      text-align: center;
    }
  }
</style>
</head>
<body>
<div class="back-nav">
  <a href="index.html">‚Üê Home</a>
  <a href="batting.html">Batting</a>
  <a href="pitching.html" class="pitching-link">Pitching Stats</a>
  <a href="leaders.html">Career Leaders</a>
  <a href="players.html">All Players</a>
  <a href="teams.html">All Teams</a>
  <a href="seasons.html">All Seasons</a>
  <a href="awards.html">League Awards</a>
  <a href="milestones.html">Batting Milestones</a>
</div>

  <!-- Mobile Navigation -->
  <div class="mobile-nav-container">
    <div class="mobile-nav-header">
      <div class="mobile-nav-title">üìà Player Comparison</div>
      <button class="hamburger-menu" onclick="toggleMobileMenu()" aria-label="Toggle navigation">‚ò∞</button>
    </div>
    <nav class="mobile-nav-menu" id="mobileNavMenu">
      <a href="index.html" class="mobile-nav-item">üè† Home</a>
      <a href="current-season.html" class="mobile-nav-item">üçÇ Current Season</a>
      <a href="weekend-preview.html" class="mobile-nav-item">üîÆ Weekend Preview</a>
      <a href="projections.html" class="mobile-nav-item">üìà Playoff Projections</a>
      <a href="batting.html" class="mobile-nav-item">‚öæ Batting Stats</a>
      <a href="pitching.html" class="mobile-nav-item">ü•é Pitching Stats</a>
      <a href="teams.html" class="mobile-nav-item">üèÜ All Teams</a>
      <a href="players.html" class="mobile-nav-item">üë§ All Players</a>
      <a href="seasons.html" class="mobile-nav-item">üìÖ All Seasons</a>
      <a href="awards.html" class="mobile-nav-item">üèÖ Awards</a>
      <a href="leaders.html" class="mobile-nav-item">üìä Career Leaders</a>
      <a href="milestones.html" class="mobile-nav-item">üéØ Milestones</a>
      <a href="compare.html" class="mobile-nav-item active">üìà Player Comparison</a>
      <a href="team_compare.html" class="mobile-nav-item">üÜö Team Comparison</a>
      <a href="h2h_grid.html" class="mobile-nav-item">‚öîÔ∏è Head-to-Head Grid</a>
	  <a href="pictures.html" class="mobile-nav-item">üì∑ Gallery</a>
    </nav>
  </div>


<h1>Player Comparison Tool</h1>

<div class="comparison-container">
  <div class="player-selector">
    <h3>Player 1</h3>
    <select id="player1Select" class="player-select">
      <option value="">Select Player 1...</option>
    </select>
  </div>
  
  <div class="player-selector">
    <h3>Player 2</h3>
    <select id="player2Select" class="player-select">
      <option value="">Select Player 2...</option>
    </select>
  </div>
</div>

<div class="comparison-type">
  <button id="careerBtn" onclick="switchComparison('career')" class="active">Career Comparison</button>
  <button id="seasonBtn" onclick="switchComparison('season')">Season Comparison</button>
</div>

<div id="seasonSelector" style="display: none; text-align: center; margin-bottom: 20px;">
  <label for="seasonSelect" style="margin-right: 10px; font-weight: bold;">Select Season:</label>
  <select id="seasonSelect" style="padding: 8px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
    <option value="">Choose a season...</option>
  </select>
</div>

<div id="comparisonResults" class="comparison-results">
  <div class="no-comparison">
    Select two players above to begin comparison
  </div>
</div>

<script>
let allData = [];
let allAwards = [];
let currentComparison = 'career';
let player1Data = null;
let player2Data = null;

// Load both batting data and awards
Promise.all([
  fetch("data.json").then(res => res.json()),
  fetch("awards.json").then(res => res.ok ? res.json() : [])
])
  .then(([battingData, awardsData]) => {
    allData = cleanData(battingData);
    allAwards = awardsData;
    populatePlayerSelects();
  })
  .catch(error => {
    console.error("Error loading data:", error);
    document.getElementById("comparisonResults").innerHTML = 
      '<div class="no-comparison">Error loading player data. Please check that data files are available.</div>';
  });

function cleanData(data) {
  return data.map(p => ({
    ...p,
    name: p.name ? p.name.trim() : "",
    team: p.team ? p.team.trim() : "",
    season: p.season ? p.season.trim() : "",
    year: p.year ? String(p.year).trim() : "",
    games: Number(p.games) || 0,
    atBats: Number(p.atBats) || 0,
    hits: Number(p.hits) || 0,
    runs: Number(p.runs) || 0,
    walks: Number(p.walks) || 0,
    AcesWar: p.AcesWar === "N/A" || !p.AcesWar ? "N/A" : Number(p.AcesWar),
    Sub: p.Sub || p.sub || ""
  }));
}

function populatePlayerSelects() {
  // Get unique players
  const players = [...new Set(allData.map(p => p.name))].filter(name => name).sort();
  
  const player1Select = document.getElementById('player1Select');
  const player2Select = document.getElementById('player2Select');
  
  players.forEach(playerName => {
    const option1 = document.createElement('option');
    option1.value = playerName;
    option1.textContent = playerName;
    player1Select.appendChild(option1);
    
    const option2 = document.createElement('option');
    option2.value = playerName;
    option2.textContent = playerName;
    player2Select.appendChild(option2);
  });
  
  player1Select.addEventListener('change', updateComparison);
  player2Select.addEventListener('change', updateComparison);
}

function updateComparison() {
  const player1Name = document.getElementById('player1Select').value;
  const player2Name = document.getElementById('player2Select').value;
  
  if (!player1Name || !player2Name) {
    document.getElementById('comparisonResults').innerHTML = 
      '<div class="no-comparison">Select two players above to begin comparison</div>';
    return;
  }
  
  if (player1Name === player2Name) {
    document.getElementById('comparisonResults').innerHTML = 
      '<div class="no-comparison">Please select two different players</div>';
    return;
  }
  
  player1Data = allData.filter(p => p.name === player1Name);
  player2Data = allData.filter(p => p.name === player2Name);
  
  // Re-populate season selector if in season mode
  if (currentComparison === 'season') {
    populateSeasonSelector();
  }
  
  renderComparison();
}

function switchComparison(type) {
  currentComparison = type;
  
  // Update button styles
  const careerBtn = document.getElementById('careerBtn');
  const seasonBtn = document.getElementById('seasonBtn');
  const seasonSelector = document.getElementById('seasonSelector');
  
  if (type === 'career') {
    careerBtn.classList.add('active');
    seasonBtn.classList.remove('active');
    seasonSelector.style.display = 'none';
  } else {
    seasonBtn.classList.add('active');
    careerBtn.classList.remove('active');
    seasonSelector.style.display = 'block';
    populateSeasonSelector();
  }
  
  renderComparison();
}

function populateSeasonSelector() {
  const seasonSelect = document.getElementById('seasonSelect');
  
  if (!player1Data || !player2Data) return;
  
  // Get all unique seasons from both players
  const allSeasons = new Set();
  
  player1Data.forEach(season => {
    allSeasons.add(`${season.year}-${season.season}`);
  });
  
  player2Data.forEach(season => {
    allSeasons.add(`${season.year}-${season.season}`);
  });
  
  // Clear existing options except first
  seasonSelect.innerHTML = '<option value="">Choose a season...</option>';
  
  // Sort seasons (most recent first)
  const sortedSeasons = Array.from(allSeasons).sort((a, b) => {
    const [yearA, seasonA] = a.split('-');
    const [yearB, seasonB] = b.split('-');
    
    if (yearB !== yearA) return parseInt(yearB) - parseInt(yearA);
    return seasonB.localeCompare(seasonA);
  });
  
  sortedSeasons.forEach(seasonKey => {
    const [year, season] = seasonKey.split('-');
    const option = document.createElement('option');
    option.value = seasonKey;
    option.textContent = `${year} ${season}`;
    seasonSelect.appendChild(option);
  });
  
  // Remove existing event listeners and add new one
  const newSeasonSelect = seasonSelect.cloneNode(true);
  seasonSelect.parentNode.replaceChild(newSeasonSelect, seasonSelect);
  newSeasonSelect.addEventListener('change', renderComparison);
}

function renderComparison() {
  if (!player1Data || !player2Data) return;
  
  const resultsDiv = document.getElementById('comparisonResults');
  
  if (currentComparison === 'career') {
    resultsDiv.innerHTML = renderCareerComparison();
  } else {
    const selectedSeason = document.getElementById('seasonSelect').value;
    if (selectedSeason) {
      resultsDiv.innerHTML = renderSeasonComparison(selectedSeason);
    } else {
      resultsDiv.innerHTML = '<div class="no-comparison">Please select a season to compare</div>';
    }
  }
}

function renderCareerComparison() {
  const player1Stats = aggregatePlayerStats(player1Data);
  const player2Stats = aggregatePlayerStats(player2Data);
  
  return `
    <div class="career-comparison">
      <div class="player-career-stats">
        <h4>${player1Stats.name}</h4>
        <div class="stat-row">
          <span class="stat-label">Games:</span>
          <span class="stat-value">${player1Stats.totalGames}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">At Bats:</span>
          <span class="stat-value">${player1Stats.totalAtBats}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Hits:</span>
          <span class="stat-value">${player1Stats.totalHits}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Runs:</span>
          <span class="stat-value">${player1Stats.totalRuns}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Walks:</span>
          <span class="stat-value">${player1Stats.totalWalks}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Batting Average:</span>
          <span class="stat-value">${player1Stats.battingAverage}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">On-Base %:</span>
          <span class="stat-value">${player1Stats.onBasePercentage}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Avg AcesBPI:</span>
          <span class="stat-value">${player1Stats.avgAcesWar}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Seasons Played:</span>
          <span class="stat-value">${player1Stats.seasonsPlayed}</span>
        </div>
        ${player1Stats.awards && player1Stats.awards !== '' ? `
        <div class="stat-row">
          <span class="stat-label">Awards:</span>
          <span class="stat-value">${player1Stats.awards}</span>
        </div>
        ` : ''}
      </div>
      
      <div class="comparison-divider">VS</div>
      
      <div class="player-career-stats">
        <h4>${player2Stats.name}</h4>
        <div class="stat-row">
          <span class="stat-label">Games:</span>
          <span class="stat-value">${player2Stats.totalGames}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">At Bats:</span>
          <span class="stat-value">${player2Stats.totalAtBats}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Hits:</span>
          <span class="stat-value">${player2Stats.totalHits}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Runs:</span>
          <span class="stat-value">${player2Stats.totalRuns}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Walks:</span>
          <span class="stat-value">${player2Stats.totalWalks}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Batting Average:</span>
          <span class="stat-value">${player2Stats.battingAverage}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">On-Base %:</span>
          <span class="stat-value">${player2Stats.onBasePercentage}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Avg AcesBPI:</span>
          <span class="stat-value">${player2Stats.avgAcesWar}</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Seasons Played:</span>
          <span class="stat-value">${player2Stats.seasonsPlayed}</span>
        </div>
        ${player2Stats.awards && player2Stats.awards !== '' ? `
        <div class="stat-row">
          <span class="stat-label">Awards:</span>
          <span class="stat-value">${player2Stats.awards}</span>
        </div>
        ` : ''}
      </div>
    </div>
  `;
}

function renderSeasonComparison(selectedSeason) {
  const [year, season] = selectedSeason.split('-');
  
  // Find the specific season data for each player
  const player1Season = player1Data.find(s => s.year === year && s.season === season);
  const player2Season = player2Data.find(s => s.year === year && s.season === season);
  
  // Get season awards for both players
  const player1SeasonAwards = getSeasonAwards(player1Data[0].name, year, season);
  const player2SeasonAwards = getSeasonAwards(player2Data[0].name, year, season);
  
  return `
    <div class="career-comparison">
      <div class="player-career-stats">
        <h4>${player1Data[0].name} - ${year} ${season}</h4>
        ${player1Season ? renderSeasonStats(player1Season, player1SeasonAwards) : '<div style="text-align: center; color: #666; font-style: italic;">Did not play this season</div>'}
      </div>
      
      <div class="comparison-divider">VS</div>
      
      <div class="player-career-stats">
        <h4>${player2Data[0].name} - ${year} ${season}</h4>
        ${player2Season ? renderSeasonStats(player2Season, player2SeasonAwards) : '<div style="text-align: center; color: #666; font-style: italic;">Did not play this season</div>'}
      </div>
    </div>
  `;
}

function renderSeasonStats(seasonData, seasonAwards) {
  const BA = seasonData.atBats > 0 ? (seasonData.hits / seasonData.atBats).toFixed(3) : ".000";
  const OBP = (seasonData.atBats + seasonData.walks) > 0 
    ? ((seasonData.hits + seasonData.walks) / (seasonData.atBats + seasonData.walks)).toFixed(3) 
    : ".000";
  const AcesWar = seasonData.AcesWar !== "N/A" && !isNaN(seasonData.AcesWar) 
    ? Number(seasonData.AcesWar).toFixed(2) 
    : "N/A";
  const subStatus = (seasonData.Sub || "").toString().trim().toLowerCase() === "yes" ? "Yes" : "No";
  
  return `
    <div class="stat-row">
      <span class="stat-label">Team:</span>
      <span class="stat-value">${seasonData.team}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Games:</span>
      <span class="stat-value">${seasonData.games}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">At Bats:</span>
      <span class="stat-value">${seasonData.atBats}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Hits:</span>
      <span class="stat-value">${seasonData.hits}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Runs:</span>
      <span class="stat-value">${seasonData.runs}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Walks:</span>
      <span class="stat-value">${seasonData.walks}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">AcesBPI:</span>
      <span class="stat-value">${AcesWar}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Batting Average:</span>
      <span class="stat-value">${BA}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">On-Base %:</span>
      <span class="stat-value">${OBP}</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Substitute:</span>
      <span class="stat-value">${subStatus}</span>
    </div>
    ${seasonAwards ? `
    <div class="stat-row">
      <span class="stat-label">Season Awards:</span>
      <span class="stat-value">${seasonAwards}</span>
    </div>
    ` : ''}
  `;
}

function getSeasonAwards(playerName, year, season) {
  const seasonAwards = allAwards.filter(award => 
    award.Player && award.Player.trim() === playerName &&
    award.Year === year && award.Season === season &&
    award.Award && award.Award.trim() !== ""
  );
  
  if (seasonAwards.length === 0) return null;
  
  // Group awards by type and count
  const awardCounts = {};
  seasonAwards.forEach(award => {
    const awardType = award.Award.trim();
    if (!awardCounts[awardType]) {
      awardCounts[awardType] = 0;
    }
    awardCounts[awardType]++;
  });
  
  // Format awards as "Award Type: Count | Award Type: Count"
  const formattedAwards = Object.entries(awardCounts)
    .sort(([a], [b]) => a.localeCompare(b)) // Sort alphabetically
    .map(([awardType, count]) => count > 1 ? `${awardType}: ${count}` : awardType);
  
  return formattedAwards.join(' | ');
}

function aggregatePlayerStats(playerData) {
  const stats = {
    name: playerData[0].name,
    totalGames: 0,
    totalAtBats: 0,
    totalHits: 0,
    totalRuns: 0,
    totalWalks: 0,
    acesWarValues: [],
    seasonsPlayed: 0,
    awards: ''
  };
  
  // Count only non-substitute seasons
  const nonSubSeasons = playerData.filter(season => {
    const subStatus = (season.Sub || "").toString().trim().toLowerCase();
    return subStatus !== "yes";
  });
  
  stats.seasonsPlayed = nonSubSeasons.length;
  
  playerData.forEach(season => {
    stats.totalGames += season.games;
    stats.totalAtBats += season.atBats;
    stats.totalHits += season.hits;
    stats.totalRuns += season.runs;
    stats.totalWalks += season.walks;
    
    if (season.AcesWar !== "N/A" && !isNaN(season.AcesWar)) {
      stats.acesWarValues.push(Number(season.AcesWar));
    }
  });
  
  // Calculate awards for this player
  const playerAwards = allAwards.filter(award => 
    award.Player && award.Player.trim() === stats.name && award.Award && award.Award.trim() !== ""
  );
  
  // Group awards by type and count
  const awardCounts = {};
  playerAwards.forEach(award => {
    const awardType = award.Award.trim();
    if (!awardCounts[awardType]) {
      awardCounts[awardType] = 0;
    }
    awardCounts[awardType]++;
  });
  
  // Format awards as "Award Type: Count | Award Type: Count"
  const formattedAwards = Object.entries(awardCounts)
    .sort(([a], [b]) => a.localeCompare(b))
    .map(([awardType, count]) => `${awardType}: ${count}`);
  
  stats.awards = formattedAwards.length > 0 ? formattedAwards.join(' | ') : '';
  
  stats.battingAverage = stats.totalAtBats > 0 ? 
    (stats.totalHits / stats.totalAtBats).toFixed(3) : ".000";
  
  stats.onBasePercentage = (stats.totalAtBats + stats.totalWalks) > 0 ? 
    ((stats.totalHits + stats.totalWalks) / (stats.totalAtBats + stats.totalWalks)).toFixed(3) : ".000";
  
  stats.avgAcesWar = stats.acesWarValues.length > 0 ?
    (stats.acesWarValues.reduce((a, b) => a + b, 0) / stats.acesWarValues.length).toFixed(2) : "N/A";
  
  return stats;
}
</script>
  <script src="team-colors.js"></script>
 <script src="mobile-enhancements.js"></script>
</body>
</html>
