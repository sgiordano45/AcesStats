<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pitching Statistics - Aces Stats</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
    line-height: 1.6;
  }
  
  .page-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }
  
  .page-header {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
    text-align: center;
    padding: 3rem 2rem;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    position: relative;
    overflow: hidden;
  }
  
  .page-header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #ffd700 0%, #ffed4e 100%);
  }
  
  .page-header h1 {
    margin: 0;
    font-size: 2.5rem;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  }
  
  .page-header p {
    margin: 1rem 0 0 0;
    font-size: 1.1rem;
    opacity: 0.9;
  }
  
  .summary {
    background: white;
    padding: 2rem;
    margin-bottom: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    border: 1px solid #e1e5e9;
    position: relative;
    overflow: hidden;
  }
  
  .summary::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%);
  }
  
  .summary h2 {
    margin: 0 0 1.5rem 0;
    color: #333;
    font-size: 1.5rem;
    font-weight: 700;
  }
  
  .summary p {
    margin: 0 0 1rem 0;
    color: #333;
    font-size: 1.1rem;
  }
  
  .summary p:last-child {
    margin-bottom: 0;
    color: #666;
    font-size: 0.95rem;
  }
  
  .filters-section {
    background: white;
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    border: 1px solid #e1e5e9;
  }
  
  .filters-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
    justify-content: center;
  }
  
  .filter-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .filter-group label {
    font-weight: 600;
    color: #333;
  }
  
  .filter-group select {
    padding: 0.5rem 1rem;
    border: 2px solid #e1e5e9;
    border-radius: 6px;
    background: white;
    color: #333;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }
  
  .filter-group select:focus {
    outline: none;
    border-color: #11998e;
  }
  
  .nav-section {
    background: white;
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    border: 1px solid #e1e5e9;
  }
  
  .nav-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
    justify-content: center;
  }
  
  .nav-link {
    padding: 0.8rem 1.5rem;
    border: 2px solid #667eea;
    background: white;
    color: #667eea;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .nav-link:hover {
    background: #667eea;
    color: white;
    transform: translateY(-2px);
  }
  
  .nav-link.batting {
    border-color: #667eea;
    color: #667eea;
  }
  
  .nav-link.batting:hover {
    background: #667eea;
    color: white;
  }
  
  .nav-link.pitching {
    border-color: #11998e;
    color: #11998e;
  }
  
  .nav-link.pitching:hover {
    background: #11998e;
    color: white;
  }
  
  .stats-table-container {
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    border: 1px solid #e1e5e9;
    position: relative;
  }
  
  .stats-table-container::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%);
  }
  
  table {
    border-collapse: collapse;
    width: 100%;
    margin: 0;
    background: white;
  }
  
  th, td {
    border: none;
    border-bottom: 1px solid #e1e5e9;
    padding: 1rem;
    text-align: center;
  }
  
  th {
    cursor: pointer;
    background: #11998e;
    color: white;
    font-weight: 600;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  
  th:hover {
    background: #0f8a80;
  }
  
  th.asc::after { content: " ▲"; }
  th.desc::after { content: " ▼"; }
  
  tbody tr:hover {
    background: #f8f9fa;
  }
  
  tbody tr:nth-child(even) {
    background: #fafafa;
  }
  
  tbody tr:nth-child(even):hover {
    background: #e8f4fd;
  }
  
  table a {
    color: #11998e;
    text-decoration: none;
    font-weight: 600;
    transition: color 0.3s ease;
  }
  
  table a:hover {
    color: #0f8a80;
    text-decoration: underline;
  }
  
  /* Loading state */
  .loading {
    text-align: center;
    padding: 3rem;
    color: #666;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.07);
    border: 1px solid #e1e5e9;
  }
  
  .loading::before {
    content: "⳺";
    display: block;
    font-size: 3rem;
    margin-bottom: 1rem;
    animation: spin 2s linear infinite;
  }
  
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
  
  /* Mobile responsive adjustments */
  @media (max-width: 768px) {
    .page-container {
      padding: 1rem;
    }
    
    .page-header {
      padding: 2rem 1rem;
    }
    
    .page-header h1 {
      font-size: 2rem;
    }
    
    .filters-container {
      flex-direction: column;
      gap: 1rem;
    }
    
    .filter-group {
      flex-direction: column;
      text-align: center;
      gap: 0.5rem;
    }
    
    .nav-container {
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .nav-link {
      padding: 10px 15px;
      font-size: 14px;
      text-align: center;
      justify-content: center;
    }
    
    th, td {
      padding: 0.75rem 0.5rem;
      font-size: 0.9em;
    }
  }
  
  @media (max-width: 480px) {
    .nav-link {
      display: block;
      margin: 0.25rem 0;
      text-align: center;
    }
    
    th, td {
      padding: 0.5rem 0.25rem;
      font-size: 0.8em;
    }
  }
</style>
  <link rel="stylesheet" href="mobile-enhancements.css">
</head>
<body>

  <!-- Mobile Navigation -->
  <div class="mobile-nav-container">
    <div class="mobile-nav-header">
      <div class="mobile-nav-title">🥎 Pitching Statistics</div>
      <button class="hamburger-menu" onclick="toggleMobileMenu()" aria-label="Toggle navigation">☰</button>
    </div>
    <nav class="mobile-nav-menu" id="mobileNavMenu">
      <a href="index.html" class="mobile-nav-item">🏠 Home</a>
      <a href="current-season.html" class="mobile-nav-item">🍂 Current Season</a>
      <a href="weekend-preview.html" class="mobile-nav-item">🔮 Weekend Preview</a>
      <a href="projections.html" class="mobile-nav-item">📈 Playoff Projections</a>
      <a href="batting.html" class="mobile-nav-item">⚾ Batting Stats</a>
      <a href="pitching.html" class="mobile-nav-item active">🥎 Pitching Stats</a>
      <a href="teams.html" class="mobile-nav-item">🏆 All Teams</a>
      <a href="players.html" class="mobile-nav-item">👤 All Players</a>
      <a href="seasons.html" class="mobile-nav-item">📅 All Seasons</a>
      <a href="awards.html" class="mobile-nav-item">🏅 Awards</a>
      <a href="leaders.html" class="mobile-nav-item">📊 Career Leaders</a>
      <a href="milestones.html" class="mobile-nav-item">🎯 Milestones</a>
      <a href="compare.html" class="mobile-nav-item">📈 Player Comparison</a>
      <a href="team_compare.html" class="mobile-nav-item">🆚 Team Comparison</a>
      <a href="h2h_grid.html" class="mobile-nav-item">⚔️ Head-to-Head Grid</a>
	  <a href="pictures.html" class="mobile-nav-item">📷 Gallery</a>
    </nav>
  </div>

<div class="page-container">
  <div class="page-header">
    <h1>⚾ Mountainside Aces Pitching Statistics</h1>
    <p>Complete pitching statistics for all players across all seasons</p>
  </div>

  <div class="summary">
    <h2>Pitching Overview</h2>
    <p id="totalsText">Loading statistics...</p>
    <p id="leadersText">Loading leaders...</p>
  </div>

  <div class="filters-section">
    <div class="filters-container">
      <div class="filter-group">
        <label for="yearFilter">Year:</label>
        <select id="yearFilter">
          <option value="All">All Years</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="seasonFilter">Season:</label>
        <select id="seasonFilter">
          <option value="All">All Seasons</option>
        </select>
      </div>
    </div>
  </div>

  <div class="nav-section">
    <div class="nav-container">
      <a href="index.html" class="nav-link">🏠 Home</a>
      <a href="batting.html" class="nav-link batting">⚾ Batting Stats</a>
      <a href="teams.html" class="nav-link">🏆 All Teams</a>
      <a href="players.html" class="nav-link">👤 All Players</a>
      <a href="seasons.html" class="nav-link">📅 All Seasons</a>
      <a href="awards.html" class="nav-link">🏅 League Awards</a>
      <a href="leaders.html" class="nav-link">📊 Batting Leaders</a>
      <a href="pitching_leaders.html" class="nav-link pitching">🥎 Pitching Leaders</a>
      <a href="milestones.html" class="nav-link">🎯 Batting Milestones</a>
      <a href="compare.html" class="nav-link">📈 Player Comparison</a>
    </div>
  </div>

  <div class="stats-table-container">
    <div class="swipe-indicator">← Swipe left/right to see all columns →</div>
    <table id="pitchingTable">
      <thead>
        <tr>
          <th data-field="name">Name</th>
          <th data-field="team">Team</th>
          <th data-field="year">Year</th>
          <th data-field="season">Season</th>
          <th data-field="games">Games</th>
          <th data-field="IP">Innings Pitched</th>
          <th data-field="runsAllowed">Runs Allowed</th>
          <th data-field="ERA">ERA</th>
        </tr>
      </thead>
      <tbody>
        <!-- Rows generated dynamically -->
      </tbody>
    </table>
  </div>
</div>

<script>
// Global variables
let allData = [];
let currentSort = { column: null, dir: "asc" };

// Load data
fetch("pitching.json")
  .then(res => res.json())
  .then(data => {
    allData = cleanData(data);
    populateFilters(allData);
    renderTable(allData);
  })
  .catch(error => {
    console.error("Error loading data:", error);
    document.body.innerHTML = `
      <div class="page-container">
        <h1>Error loading pitching statistics data</h1>
        <p>Please check that pitching.json is available.</p>
        <p><a href="index.html">Return to home</a></p>
      </div>
    `;
  });

function cleanData(data) {
  return data.map(p => ({
    ...p,
    name: p.name ? p.name.trim() : "",
    team: p.team ? p.team.trim() : "",
    season: p.season ? p.season.trim() : "",
    year: p.year ? String(p.year).trim() : "",
    games: Number(p.games) || 0,
    IP: p.IP ? String(p.IP).trim() : "0",
    runsAllowed: Number(p["runs allowed"]) || 0,
    ERA: p.ERA === "N/A" || !p.ERA ? "N/A" : Number(p.ERA)
  }));
}

function populateFilters(data) {
  const years = [...new Set(data.map(p => p.year))].sort((a, b) => b.localeCompare(a));
  const seasons = [...new Set(data.map(p => p.season))].sort();

  const yearFilter = document.getElementById("yearFilter");
  const seasonFilter = document.getElementById("seasonFilter");

  years.forEach(y => {
    let opt = document.createElement("option");
    opt.value = y;
    opt.textContent = y;
    yearFilter.appendChild(opt);
  });

  seasons.forEach(s => {
    let opt = document.createElement("option");
    opt.value = s;
    opt.textContent = s;
    seasonFilter.appendChild(opt);
  });

  yearFilter.addEventListener("change", applyFilters);
  seasonFilter.addEventListener("change", applyFilters);
}

function applyFilters() {
  const yearVal = document.getElementById("yearFilter").value;
  const seasonVal = document.getElementById("seasonFilter").value;

  let filtered = allData.filter(
    p =>
      (yearVal === "All" || p.year === yearVal) &&
      (seasonVal === "All" || p.season === seasonVal)
  );

  renderTable(filtered);
}

function renderTable(data) {
  const tbody = document.querySelector("#pitchingTable tbody");
  tbody.innerHTML = "";

  if (data.length === 0) {
    tbody.innerHTML = '<tr><td colspan="8">No data matches the current filters.</td></tr>';
    document.getElementById("totalsText").textContent = "No data to display.";
    document.getElementById("leadersText").textContent = "";
    return;
  }

  // Calculate totals
  let totals = {
    games: 0,
    totalIP: 0,
    runsAllowed: 0,
  };

  data.forEach(p => {
    totals.games += p.games;
    totals.totalIP += parseFloat(p.IP) || 0;
    totals.runsAllowed += p.runsAllowed;
  });

  // Find leaders - only consider pitchers with meaningful innings
  const qualifyingPitchers = data.filter(p => parseFloat(p.IP) >= 10);
  let leaders = {};
  
  // Counting stats leaders
  ["games", "runsAllowed"].forEach(stat => {
    let maxPitcher = data.reduce((prev, curr) =>
      curr[stat] > prev[stat] ? curr : prev,
      { [stat]: -1 }
    );
    leaders[stat] = maxPitcher.name ? `${maxPitcher.name} (${maxPitcher[stat]})` : "N/A";
  });

  // Innings Pitched leader
  let mostIP = data.reduce((prev, curr) => {
    let currIP = parseFloat(curr.IP) || 0;
    let prevIP = parseFloat(prev.IP) || 0;
    return currIP > prevIP ? curr : prev;
  }, { IP: "0" });
  leaders.IP = mostIP.name ? `${mostIP.name} (${mostIP.IP})` : "N/A";

  // ERA leader (minimum 10 innings)
  let bestERA = qualifyingPitchers.reduce((prev, curr) => {
    let currERA = (curr.ERA !== "N/A" && !isNaN(curr.ERA)) ? Number(curr.ERA) : Infinity;
    let prevERA = (prev.ERA !== "N/A" && !isNaN(prev.ERA)) ? Number(prev.ERA) : Infinity;
    return currERA < prevERA ? curr : prev;
  }, { ERA: Infinity });
  leaders.ERA = bestERA.name ? 
    `${bestERA.name} (${Number(bestERA.ERA).toFixed(2)})` : "N/A";

  // Update summary text
  document.getElementById("totalsText").textContent =
    `Totals — Games: ${totals.games}, Innings Pitched: ${totals.totalIP.toFixed(1)}, Runs Allowed: ${totals.runsAllowed}`;

  document.getElementById("leadersText").innerHTML = `
    Season Leaders — Games: ${leaders.games}, Innings Pitched: ${leaders.IP}, Runs Allowed: ${leaders.runsAllowed}, Best ERA: ${leaders.ERA}<br>
    <a href="pitching_leaders.html" style="color: #11998e; text-decoration: none; font-weight: normal;">Pitching Career Leaders →</a>
  `;

  // Generate table rows
  data.forEach(p => {
    const row = document.createElement("tr");
    
    const ERA = p.ERA !== "N/A" && !isNaN(p.ERA)
      ? Number(p.ERA).toFixed(2)
      : "N/A";

    row.innerHTML = `
      <td><a href="pitcher.html?name=${encodeURIComponent(p.name)}">${p.name}</a></td>
      <td><a href="team.html?team=${encodeURIComponent(p.team)}">${p.team}</a></td>
      <td>${p.year}</td>
      <td>${p.season}</td>
      <td>${p.games}</td>
      <td>${p.IP}</td>
      <td>${p.runsAllowed}</td>
      <td>${ERA}</td>
    `;
    tbody.appendChild(row);
  });

  attachSorting();
}

function attachSorting() {
  const headers = document.querySelectorAll("#pitchingTable th");
  headers.forEach((th, idx) => {
    th.onclick = () => sortTable(idx, th.getAttribute("data-field"));
  });
}

function sortTable(columnIndex, field) {
  const table = document.getElementById("pitchingTable");
  const rows = Array.from(table.rows).slice(1);

  let dir = currentSort.column === field && currentSort.dir === "asc" ? "desc" : "asc";
  currentSort = { column: field, dir };

  rows.sort((a, b) => {
    let x = a.cells[columnIndex].innerText.trim();
    let y = b.cells[columnIndex].innerText.trim();

    // Handle special cases
    if (field === "ERA") {
      // Move N/A values to the end
      if (x === "N/A" && y !== "N/A") return 1;
      if (y === "N/A" && x !== "N/A") return -1;
      if (x === "N/A" && y === "N/A") return 0;
    }

    // Handle IP field (innings pitched can have decimals)
    if (field === "IP") {
      let xNum = parseFloat(x);
      let yNum = parseFloat(y);
      if (!isNaN(xNum) && !isNaN(yNum)) {
        return dir === "asc" ? xNum - yNum : yNum - xNum;
      }
    }

    // Try parsing as numbers first
    let xNum = parseFloat(x.replace(/,/g, ""));
    let yNum = parseFloat(y.replace(/,/g, ""));

    if (!isNaN(xNum) && !isNaN(yNum)) {
      return dir === "asc" ? xNum - yNum : yNum - xNum;
    }

    // Fall back to string comparison
    return dir === "asc" ? x.localeCompare(y) : y.localeCompare(x);
  });

  // Re-append sorted rows
  rows.forEach(row => table.tBodies[0].appendChild(row));

  // Update sort indicators
  document.querySelectorAll("#pitchingTable th").forEach(th => th.classList.remove("asc", "desc"));
  table.rows[0].cells[columnIndex].classList.add(dir);
}
</script>
 <script src="mobile-enhancements.js"></script>
</body>
</html>